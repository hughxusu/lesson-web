# 滚动事件和元素大小

## 滚动事件

当页面进行滚动时触发的事件，事件名`scroll`。监听滚动事件的作用：有时候网页需要检测，用户把页面滚动到某个区域后，做特定处理， 比如：固定导航栏、返回顶部按钮等。

1. 监听整个页面的滚动事件。

```js
window.addEventListener('scroll', function () {
    console.log('scroll')
})
```

2. 监听某个元素的滚动事件，直接给某个元素加即可。

```html
<body>
    <h1>侠客行</h1>
    <p>
        赵客缦胡缨，吴钩霜雪明。<br>
        银鞍照白马，飒沓如流星。<br>
        十步杀一人，千里不留行。<br>
				......
    </p>
</body>
<script>
    let p = document.querySelector('p')
    p.addEventListener('scroll', function () {
        console.log('scroll')
    })
</script>
```

## 事件加载

外部资源加载完毕时，触发的事件`load`。有时需要等待页面资源，全部加载完毕后，集中处理一些任务，所以需要监听页面加载完成事件。给`window`添加`load`事件可以监听整个页面元素全部加载完成。

```html
<head>
    <script>    
        window.addEventListener('load', function () {
            let p = document.querySelector('p')
            console.log(p);
        })
    </script>
</head>
<body>
    <h1>侠客行</h1>
    <p>
        赵客缦胡缨，吴钩霜雪明。<br>
        银鞍照白马，飒沓如流星。<br>
        十步杀一人，千里不留行。<br>
				......
    </p>
</body>
```

> [!warning]
>
> 不光可以监听整个页面资源加载完毕，也可以针对某个资源绑定`load`事件。

当初始的HTML文档被完全加载和解析完成之后，`DOMContentLoaded`事件被触发，而无需等待样式表 、图像等完全加载。

```js
window.addEventListener('DOMContentLoaded', function () {
    let p = document.querySelector('p')
    console.log(p);
})
```

## 元素大小和位置

###  scroll

使用`scroll`属性来检测页面滚动的距离

* `scrollWidth`和`scrollHeight`：获取元素内容总宽高（不包含滚动条），返回数值。
* `scrollLeft`和`scrollTop`：获取元素内容往左、往上滚动出去看不到的距离，值可读写。

<img src="https://raw.githubusercontent.com/hughxusu/lesson-web/develop/images/d-js/content-scroll.ae039874.png" style="zoom:55%;" />

```js
let div = document.querySelector('div')
let lis = document.querySelectorAll('ul li')
lis[0].innerText = `scrollWidth: ${div.scrollWidth}px, scrollHeight: ${div.scrollHeight}px`
div.addEventListener('scroll',function () {
        lis[1].innerText = `scrollTop: ${div.scrollTop}px, scrollLeft: ${div.scrollLeft}px`
    }
)
```

### offset

* `offsetWidth`和`offsetHeight`：获取元素自身盒子模型的宽和高，包含内容宽高、`padding`、`border`。

* `offsetLeft`和`offsetTop`：获取元素距离自己定位父级元素的左、上距离（只读属性）。如果父级元素都没有定位，则对应对于`body`。

<img src="https://raw.githubusercontent.com/hughxusu/lesson-web/develop/images/d-js/offset.835e44d4.png" style="zoom:55%;" />

```js
lis[2].innerText = `offsetWidth: ${div.offsetWidth}px, offsetHeight: ${div.offsetHeight}px`
lis[3].innerText = `offsetTop: ${div.offsetTop}px, offsetLeft: ${div.offsetLeft}px`
```

### client

* `clientWidth`和`clientHeight`：获取元素的可见部分宽高（包含padding，不包含边框，滚动条）

* `clientLeft`和`clientTop`：获取左边框和上边框宽度

<img src="https://raw.githubusercontent.com/hughxusu/lesson-web/develop/images/d-js/content-view.b1e68a59.png" style="zoom:55%;" />

```js
lis[4].innerText = `clientWidth: ${div.clientWidth}px, clientHeight: ${div.clientHeight}px`
lis[5].innerText = `clientTop: ${div.clientTop}px, clientLeft: ${div.clientLeft}px`
```

### 综合案例

返回页面顶部

```js
let btn = document.querySelector('button')
let p = document.querySelector('p')
window.addEventListener('scroll', function () {
    let num = document.documentElement.scrollTop
    if (num >= p.offsetTop) {
        btn.style.display = 'block'
    } else {
        btn.style.display = 'none'
    }
})

btn.addEventListener('click', function () {
    document.documentElement.scrollTop = 0
})
```

## resize

窗口尺寸改变时会触发事件`resize`。

```js
function render() {
    let w = document.documentElement.clientWidth
    if (w >= 1200) {
        document.body.style.backgroundColor = 'red'
    } else if (w > 800) {
        document.body.style.backgroundColor = 'blue'
    } else {
        document.body.style.backgroundColor = 'green'
    }
}

render()
window.addEventListener('resize', render)
```





